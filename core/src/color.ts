// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license. 

/**
 * RBGA color
 * [R, G, B, A] = [[0,1], [0,1], [0,1], [0,1]]
 */
export type ColorRGBA = [number, number, number, number];
/**
 * RGB color
 * [R, G, B] = [[0,1], [0,1], [0,1]]
 */
export type ColorRGB = [number, number, number];

/**
 * HSV color (8-bit)
 * [R, G, B] = [[0,360], [0,100], [0,100]]
 */
export type ColorHSV = [number, number, number];

export class Color {
    public static numberToColorRGBA(number: number, color: ColorRGBA) {
        color[0] = (number & 0xff) / 0xff; // r, [0,255]
        color[1] = ((number & 0xff00) >>> 8) / 0xff; // g, [256,65535]
        color[2] = ((number & 0xff0000) >>> 16) / 0xff; // b, [65536,16777215]
        color[3] = ((number & 0xff000000) >>> 24) / 0xff; // a, [16777216,4294967295]
    }

    public static colorRGBAToNumber(color: ColorRGBA): number {
        return color[0] * 0xff + ((color[1] * 0xff) << 8) + ((color[2] * 0xff) << 16) + ((color[3] * 0xff) << 24);
    }

    /**
     * Converts RGB to HSV
     * If S = 0, then H = -1 (undefined)
     * If R = G = B = 0, then H = S = -1 (undefined)
     * @param r red [0,1]
     * @param g green [0,1]
     * @param b blue [0,1]
     * @param hsv hue [0,360], saturation [0,1], value [0,1]
     */
    public static rgbToHsv(r: number, g: number, b: number, hsv: ColorHSV) {
        let h: number, s: number, v: number, delta: number;
        const min = Math.min(Math.min(r, g), b);
        const max = Math.max(Math.max(r, g), b);
        delta = max - min;
        v = max;
        if (delta == 0) {
            // r = g = b, h is undefined
            h = -1;
            if (max == 0) { s = -1; } // r = g = b = 0, s is undefined
            else { s = 0; }
            hsv[0] = h, hsv[1] = s, hsv[2] = v;
        }

        // max > 0
        s = delta / max;
        if (r == max) { h = (g - b) / delta; } // Between yellow & magenta
        else if (g == max) { h = 2 + (b - r) / delta; } // Between cyan & yellow
        else { h = 4 + (r - g) / delta; } // Between magenta & cyan

        // Degrees
        h *= 60;
        if (h < 0) { h += 360; }
        hsv[0] = h, hsv[1] = s, hsv[2] = v;
    }

    /**
     * Converts from HSV to RGB
     * @param h hue [0,360]
     * @param s saturation [0,1]
     * @param v value [0,1]
     * @param rgb red [0,1], green [0,1], blue [0,1]
     */
    public static hsvToRgb(h: number, s: number, v: number, rgb: ColorRGB) {
        let sextant: number, r: number, g: number, b: number;
        if (s == 0) {
            // Achromatic (grey)
            r = g = b = v;
            rgb[0] = r, rgb[1] = g, rgb[2] = b;
        }

        // Sextant 0 to 5
        h %= 360;
        h /= 60;
        sextant = Math.floor(h);

        // Fractional part of h
        let frac: number, p: number, q: number, t: number;
        frac = h - sextant;
        p = v * (1 - s);
        q = v * (1 - s * frac);
        t = v * (1 - s * (1 - frac));
        switch (sextant) {
            case 0:
                r = v, g = t, b = p;
                break;
            case 1:
                r = q, g = v, b = p;
                break;
            case 2:
                r = p, g = v, b = t;
                break;
            case 3:
                r = p, g = q, b = v;
                break;
            case 4:
                r = t, g = p, b = v;
                break;
            default:
                r = v, g = p, b = q;
                break;
        }
        rgb[0] = r, rgb[1] = g, rgb[2] = b;
    }
}

// Non-gamma corrected (linear space)
export const Colors: { [key: string]: ColorRGB } = {
    "mediumvioletred": [0xc7 / 0xff, 0x15 / 0xff, 0x85 / 0xff],
    "deeppink": [0xff / 0xff, 0x14 / 0xff, 0x93 / 0xff],
    "palevioletred": [0xdb / 0xff, 0x70 / 0xff, 0x93 / 0xff],
    "hotpink": [0xff / 0xff, 0x69 / 0xff, 0xb4 / 0xff],
    "lightpink": [0xff / 0xff, 0xb6 / 0xff, 0xc1 / 0xff],
    "pink": [0xff / 0xff, 0xc0 / 0xff, 0xcb / 0xff],
    "darkred": [0x8b / 0xff, 0x00 / 0xff, 0x00 / 0xff],
    "red": [0xff / 0xff, 0x00 / 0xff, 0x00 / 0xff],
    "firebrick": [0xb2 / 0xff, 0x22 / 0xff, 0x22 / 0xff],
    "crimson": [0xdc / 0xff, 0x14 / 0xff, 0x3c / 0xff],
    "indianred": [0xcd / 0xff, 0x5c / 0xff, 0x5c / 0xff],
    "lightcoral": [0xf0 / 0xff, 0x80 / 0xff, 0x80 / 0xff],
    "salmon": [0xfa / 0xff, 0x80 / 0xff, 0x72 / 0xff],
    "darksalmon": [0xe9 / 0xff, 0x96 / 0xff, 0x7a / 0xff],
    "lightsalmon": [0xff / 0xff, 0xa0 / 0xff, 0x7a / 0xff],
    "orangered": [0xff / 0xff, 0x45 / 0xff, 0x00 / 0xff],
    "tomato": [0xff / 0xff, 0x63 / 0xff, 0x47 / 0xff],
    "darkorange": [0xff / 0xff, 0x8c / 0xff, 0x00 / 0xff],
    "coral": [0xff / 0xff, 0x7f / 0xff, 0x50 / 0xff],
    "orange": [0xff / 0xff, 0xa5 / 0xff, 0x00 / 0xff],
    "darkkhaki": [0xbd / 0xff, 0xb7 / 0xff, 0x6b / 0xff],
    "gold": [0xff / 0xff, 0xd7 / 0xff, 0x00 / 0xff],
    "khaki": [0xf0 / 0xff, 0xe6 / 0xff, 0x8c / 0xff],
    "peachpuff": [0xff / 0xff, 0xda / 0xff, 0xb9 / 0xff],
    "yellow": [0xff / 0xff, 0xff / 0xff, 0x00 / 0xff],
    "palegoldenrod": [0xee / 0xff, 0xe8 / 0xff, 0xaa / 0xff],
    "moccasin": [0xff / 0xff, 0xe4 / 0xff, 0xb5 / 0xff],
    "papayawhip": [0xff / 0xff, 0xef / 0xff, 0xd5 / 0xff],
    "lightgoldenrodyellow": [0xfa / 0xff, 0xfa / 0xff, 0xd2 / 0xff],
    "lemonchiffon": [0xff / 0xff, 0xfa / 0xff, 0xcd / 0xff],
    "lightyellow": [0xff / 0xff, 0xff / 0xff, 0xe0 / 0xff],
    "maroon": [0x80 / 0xff, 0x00 / 0xff, 0x00 / 0xff],
    "brown": [0xa5 / 0xff, 0x2a / 0xff, 0x2a / 0xff],
    "saddlebrown": [0x8b / 0xff, 0x45 / 0xff, 0x13 / 0xff],
    "sienna": [0xa0 / 0xff, 0x52 / 0xff, 0x2d / 0xff],
    "chocolate": [0xd2 / 0xff, 0x69 / 0xff, 0x1e / 0xff],
    "darkgoldenrod": [0xb8 / 0xff, 0x86 / 0xff, 0x0b / 0xff],
    "peru": [0xcd / 0xff, 0x85 / 0xff, 0x3f / 0xff],
    "rosybrown": [0xbc / 0xff, 0x8f / 0xff, 0x8f / 0xff],
    "goldenrod": [0xda / 0xff, 0xa5 / 0xff, 0x20 / 0xff],
    "sandybrown": [0xf4 / 0xff, 0xa4 / 0xff, 0x60 / 0xff],
    "tan": [0xd2 / 0xff, 0xb4 / 0xff, 0x8c / 0xff],
    "burlywood": [0xde / 0xff, 0xb8 / 0xff, 0x87 / 0xff],
    "wheat": [0xf5 / 0xff, 0xde / 0xff, 0xb3 / 0xff],
    "navajowhite": [0xff / 0xff, 0xde / 0xff, 0xad / 0xff],
    "bisque": [0xff / 0xff, 0xe4 / 0xff, 0xc4 / 0xff],
    "blanchedalmond": [0xff / 0xff, 0xeb / 0xff, 0xcd / 0xff],
    "cornsilk": [0xff / 0xff, 0xf8 / 0xff, 0xdc / 0xff],
    "darkgreen": [0x00 / 0xff, 0x64 / 0xff, 0x00 / 0xff],
    "green": [0x00 / 0xff, 0x80 / 0xff, 0x00 / 0xff],
    "darkolivegreen": [0x55 / 0xff, 0x6b / 0xff, 0x2f / 0xff],
    "forestgreen": [0x22 / 0xff, 0x8b / 0xff, 0x22 / 0xff],
    "seagreen": [0x2e / 0xff, 0x8b / 0xff, 0x57 / 0xff],
    "olive": [0x80 / 0xff, 0x80 / 0xff, 0x00 / 0xff],
    "olivedrab": [0x6b / 0xff, 0x8e / 0xff, 0x23 / 0xff],
    "mediumseagreen": [0x3c / 0xff, 0xb3 / 0xff, 0x71 / 0xff],
    "limegreen": [0x32 / 0xff, 0xcd / 0xff, 0x32 / 0xff],
    "lime": [0x00 / 0xff, 0xff / 0xff, 0x00 / 0xff],
    "springgreen": [0x00 / 0xff, 0xff / 0xff, 0x7f / 0xff],
    "mediumspringgreen": [0x00 / 0xff, 0xfa / 0xff, 0x9a / 0xff],
    "darkseagreen": [0x8f / 0xff, 0xbc / 0xff, 0x8f / 0xff],
    "mediumaquamarine": [0x66 / 0xff, 0xcd / 0xff, 0xaa / 0xff],
    "yellowgreen": [0x9a / 0xff, 0xcd / 0xff, 0x32 / 0xff],
    "lawngreen": [0x7c / 0xff, 0xfc / 0xff, 0x00 / 0xff],
    "chartreuse": [0x7f / 0xff, 0xff / 0xff, 0x00 / 0xff],
    "lightgreen": [0x90 / 0xff, 0xee / 0xff, 0x90 / 0xff],
    "greenyellow": [0xad / 0xff, 0xff / 0xff, 0x2f / 0xff],
    "palegreen": [0x98 / 0xff, 0xfb / 0xff, 0x98 / 0xff],
    "teal": [0x00 / 0xff, 0x80 / 0xff, 0x80 / 0xff],
    "darkcyan": [0x00 / 0xff, 0x8b / 0xff, 0x8b / 0xff],
    "lightseagreen": [0x20 / 0xff, 0xb2 / 0xff, 0xaa / 0xff],
    "cadetblue": [0x5f / 0xff, 0x9e / 0xff, 0xa0 / 0xff],
    "darkturquoise": [0x00 / 0xff, 0xce / 0xff, 0xd1 / 0xff],
    "mediumturquoise": [0x48 / 0xff, 0xd1 / 0xff, 0xcc / 0xff],
    "turquoise": [0x40 / 0xff, 0xe0 / 0xff, 0xd0 / 0xff],
    "aqua": [0x00 / 0xff, 0xff / 0xff, 0xff / 0xff],
    "cyan": [0x00 / 0xff, 0xff / 0xff, 0xff / 0xff],
    "aquamarine": [0x7f / 0xff, 0xff / 0xff, 0xd4 / 0xff],
    "paleturquoise": [0xaf / 0xff, 0xee / 0xff, 0xee / 0xff],
    "lightcyan": [0xe0 / 0xff, 0xff / 0xff, 0xff / 0xff],
    "navy": [0x00 / 0xff, 0x00 / 0xff, 0x80 / 0xff],
    "darkblue": [0x00 / 0xff, 0x00 / 0xff, 0x8b / 0xff],
    "mediumblue": [0x00 / 0xff, 0x00 / 0xff, 0xcd / 0xff],
    "blue": [0x00 / 0xff, 0x00 / 0xff, 0xff / 0xff],
    "midnightblue": [0x19 / 0xff, 0x19 / 0xff, 0x70 / 0xff],
    "royalblue": [0x41 / 0xff, 0x69 / 0xff, 0xe1 / 0xff],
    "steelblue": [0x46 / 0xff, 0x82 / 0xff, 0xb4 / 0xff],
    "dodgerblue": [0x1e / 0xff, 0x90 / 0xff, 0xff / 0xff],
    "deepskyblue": [0x00 / 0xff, 0xbf / 0xff, 0xff / 0xff],
    "cornflowerblue": [0x64 / 0xff, 0x95 / 0xff, 0xed / 0xff],
    "skyblue": [0x87 / 0xff, 0xce / 0xff, 0xeb / 0xff],
    "lightskyblue": [0x87 / 0xff, 0xce / 0xff, 0xfa / 0xff],
    "lightsteelblue": [0xb0 / 0xff, 0xc4 / 0xff, 0xde / 0xff],
    "lightblue": [0xad / 0xff, 0xd8 / 0xff, 0xe6 / 0xff],
    "powderblue": [0xb0 / 0xff, 0xe0 / 0xff, 0xe6 / 0xff],
    "indigo": [0x4b / 0xff, 0x00 / 0xff, 0x82 / 0xff],
    "purple": [0x80 / 0xff, 0x00 / 0xff, 0x80 / 0xff],
    "darkmagenta": [0x8b / 0xff, 0x00 / 0xff, 0x8b / 0xff],
    "darkviolet": [0x94 / 0xff, 0x00 / 0xff, 0xd3 / 0xff],
    "darkslateblue": [0x48 / 0xff, 0x3d / 0xff, 0x8b / 0xff],
    "blueviolet": [0x8a / 0xff, 0x2b / 0xff, 0xe2 / 0xff],
    "darkorchid": [0x99 / 0xff, 0x32 / 0xff, 0xcc / 0xff],
    "fuchsia": [0xff / 0xff, 0x00 / 0xff, 0xff / 0xff],
    "magenta": [0xff / 0xff, 0x00 / 0xff, 0xff / 0xff],
    "slateblue": [0x6a / 0xff, 0x5a / 0xff, 0xcd / 0xff],
    "mediumslateblue": [0x7b / 0xff, 0x68 / 0xff, 0xee / 0xff],
    "mediumorchid": [0xba / 0xff, 0x55 / 0xff, 0xd3 / 0xff],
    "mediumpurple": [0x93 / 0xff, 0x70 / 0xff, 0xdb / 0xff],
    "orchid": [0xda / 0xff, 0x70 / 0xff, 0xd6 / 0xff],
    "violet": [0xee / 0xff, 0x82 / 0xff, 0xee / 0xff],
    "plum": [0xdd / 0xff, 0xa0 / 0xff, 0xdd / 0xff],
    "thistle": [0xd8 / 0xff, 0xbf / 0xff, 0xd8 / 0xff],
    "lavender": [0xe6 / 0xff, 0xe6 / 0xff, 0xfa / 0xff],
    "mistyrose": [0xff / 0xff, 0xe4 / 0xff, 0xe1 / 0xff],
    "antiquewhite": [0xfa / 0xff, 0xeb / 0xff, 0xd7 / 0xff],
    "linen": [0xfa / 0xff, 0xf0 / 0xff, 0xe6 / 0xff],
    "beige": [0xf5 / 0xff, 0xf5 / 0xff, 0xdc / 0xff],
    "whitesmoke": [0xf5 / 0xff, 0xf5 / 0xff, 0xf5 / 0xff],
    "lavenderblush": [0xff / 0xff, 0xf0 / 0xff, 0xf5 / 0xff],
    "oldlace": [0xfd / 0xff, 0xf5 / 0xff, 0xe6 / 0xff],
    "aliceblue": [0xf0 / 0xff, 0xf8 / 0xff, 0xff / 0xff],
    "seashell": [0xff / 0xff, 0xf5 / 0xff, 0xee / 0xff],
    "ghostwhite": [0xf8 / 0xff, 0xf8 / 0xff, 0xff / 0xff],
    "honeydew": [0xf0 / 0xff, 0xff / 0xff, 0xf0 / 0xff],
    "floralwhite": [0xff / 0xff, 0xfa / 0xff, 0xf0 / 0xff],
    "azure": [0xf0 / 0xff, 0xff / 0xff, 0xff / 0xff],
    "mintcream": [0xf5 / 0xff, 0xff / 0xff, 0xfa / 0xff],
    "snow": [0xff / 0xff, 0xfa / 0xff, 0xfa / 0xff],
    "ivory": [0xff / 0xff, 0xff / 0xff, 0xf0 / 0xff],
    "white": [0xff / 0xff, 0xff / 0xff, 0xff / 0xff],
    "black": [0x00 / 0xff, 0x00 / 0xff, 0x00 / 0xff],
    "darkslategray": [0x2f / 0xff, 0x4f / 0xff, 0x4f / 0xff],
    "dimgray": [0x69 / 0xff, 0x69 / 0xff, 0x69 / 0xff],
    "slategray": [0x70 / 0xff, 0x80 / 0xff, 0x90 / 0xff],
    "gray": [0x80 / 0xff, 0x80 / 0xff, 0x80 / 0xff],
    "lightslategray": [0x77 / 0xff, 0x88 / 0xff, 0x99 / 0xff],
    "darkgray": [0xa9 / 0xff, 0xa9 / 0xff, 0xa9 / 0xff],
    "silver": [0xc0 / 0xff, 0xc0 / 0xff, 0xc0 / 0xff],
    "lightgray": [0xd3 / 0xff, 0xd3 / 0xff, 0xd3 / 0xff],
    "gainsboro": [0xdc / 0xff, 0xdc / 0xff, 0xdc / 0xff],

    // Metal
    "copper": [0xb8 / 0xff, 0x73 / 0xff, 0x33 / 0xff],
    "bronze": [0xcd / 0xff, 0x7f / 0xff, 0x32 / 0xff],
    "steel": [0xce / 0xff, 0xd2 / 0xff, 0xd7 / 0xff],
    "platinum": [0xe5 / 0xff, 0xe4 / 0xff, 0xe2 / 0xff],
    "gunmetal": [0x5c / 0xff, 0x5d / 0xff, 0x5b / 0xff],
    "titanium": [0x87 / 0xff, 0x86 / 0xff, 0x81 / 0xff],
    "rosegold": [0xcb / 0xff, 0xa3 / 0xff, 0xb2 / 0xff],

    // Glass
    "aquaglass": [0xd2 / 0xff, 0xe8 / 0xff, 0xdf / 0xff],
    "blueglass": [0xc7 / 0xff, 0xe3 / 0xff, 0xe1 / 0xff],
}